<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>defaulty</title>
    <!-- defaulty 0.2.1 -->
    <link rel="stylesheet" href="css/normalize.css" />
    <script type="text/javascript" src="js/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="js/chance.min.js"></script>
</head>
<body>


<script type="text/javascript">

    function Defaulty() {
        this.container        = $('<div />');
        this.length           = 0;
        this.elements         = [];
        this.divider          = chance.natural({ min: 5, max: 50 });
        this.difference       = 0;

        this.init();

    }


    Defaulty.prototype.calculateLength = function() {
        var width = $(window).width();

        this.length     = Math.ceil(width / this.divider);
        this.difference = this.length * this.divider - width;

        if (this.difference > this.length) {
            this.divider   += 1;
            this.calculateLength();
        }
    }


    Defaulty.prototype.init = function() {
        this.calculateLength();

        // create some elements
        var numberOfElements = Math.ceil($(window).height() / this.length) * this.divider - 1;

        for (var i = 0; i <= numberOfElements; i++) {
            var isLastElement = false;

            if ( (i + 1) % this.divider == 0) {
                isLastElement = true;
            }

            // create element
            var last    = this.elements[i-1];
            var element = new Element(this.length, this.length);

            // correct width
            if (isLastElement) {
                element.setWidth(this.length - this.difference);
            }


            element.element.appendTo(this.container);
            this.elements.push(element);
        }

        this.container.prependTo($('body'));
    }


    function Element(width, height) {
        this._width    = width;
        this._height   = height;
        this.element  = $('<div />')
                .addClass('item')
                .width(this._width)
                .height(this._height)
                .css('cursor', 'pointer')
                .css('float', 'left')
        ;

        // change background color
        this.changeBackgroundColor();

        setInterval($.proxy(this.changeBackgroundColor, this), chance.natural({min: 500, max: 1500}));

        // click listener
        this.element.click($.proxy(function() {
            this.changeBackgroundColor();
        }, this));
    }


    Element.prototype.setWidth = function(width) {
        this._width = width;
        this.element.width(width);
    }


    Element.prototype.changeBackgroundColor = function() {
        this.element.css('backgroundColor', chance.color());
    }


    new Defaulty();

</script>

</body>
</html>